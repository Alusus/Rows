import "Data";
import "AutoBuild";
import "TableBuilder";

use DataType;
use Srl;
use Core.Basic;
use Core.Data;
use Core.Data.Ast;
use DbConBuilder;

class MyCars {
    @notnull
    @pk
    @Integer
    def id :int;

    @VarChar
    @defult["'My Car'" ]
    def name:String;

    @Float
    def price:float;
    Rows.getDataType[String("MyCars") , String("mycarTable") , MyCars~ast]
}

class cars {
    def id : int;
    def name : String;
    def price : float;

    Rows.getDataType[String("cars") , cars~ast ]
}

def DbName: String = "testdb";
def UserName: String = "user12";
def Password: String = "Qwerty231@#!";
def server: String = "localhost";

def DbsCon:  DbConBuilder;
DbsCon.setDBName(DbName);
DbsCon.setUserName(UserName);
DbsCon.setPassword(Password);
DbsCon.setServer(server);
DbsCon.setDbConType(0);

def c: MyCars;
def d: Array[MyCars];
c.setDbCon(DbsCon);

def i: int = 1;
for i = 1, i < 30, i = i + 1 {
    c.id = i
    c.name = String("'Car ") + i + String("'");
    c.price = 200.0 * i
    c.saveData();
}

c.id = 900;
c.name = String("'alusus Car'");
c.price = 2500000.50;
c.saveData();

d = MyCars.where[not (price $ (200  , 500)) and  id > 2 ].getData();
def k: int = 0;

Console.print("\n");
Console.print("\n");
for k = 0, k < d.getLength(), k = k + 1 {
    Console.print(d(k).id);
    Console.print("  ");
    Console.print(d(k).name);
    Console.print("  ");
    Console.print(d(k).price);
    Console.print("\n");
}

MyCars.where[id = 20]
MyCars.updateDataSet[(price = 90, name = "BMW")];
d = c.getData();

Console.print("\n");
Console.print("\n");
for k = 0, k < d.getLength(), k = k + 1 {
    Console.print(d(k).id);
    Console.print("  ");
    Console.print(d(k).name);
    Console.print("  ");
    Console.print(d(k).price);
    Console.print("\n");
}

